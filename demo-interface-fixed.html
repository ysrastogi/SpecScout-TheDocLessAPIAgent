<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doc-less API Agent Demo</title>
    <!-- Prevent favicon.ico requests -->
    <link rel="icon" href="data:,">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #0f1419 0%, #1a1a1a 100%);
            color: #e6edf3;
            line-height: 1.6;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 24px;
            margin: 20px 0;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }
        
        .demo-button {
            background: linear-gradient(135deg, #238636, #2ea043);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            margin: 8px;
            transition: all 0.3s ease;
        }
        
        .demo-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .demo-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .terminal {
            background: #0d1117;
            color: #00ff41;
            font-family: 'SF Mono', Monaco, monospace;
            padding: 20px;
            border-radius: 8px;
            min-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
            border: 1px solid #30363d;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #21262d;
            border-radius: 4px;
            overflow: hidden;
            margin: 16px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #238636, #2ea043);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-card {
            text-align: center;
            padding: 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2ea043;
            display: block;
        }
        
        .highlight {
            color: #ff8552;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <header class="text-center">
        <h1 style="font-size: 3em; margin-bottom: 8px;">🤖 Doc-less API Agent</h1>
        <p style="font-size: 1.2em; color: #ffc107;">Live Interactive Demo</p>
        <p style="color: #6c757d;">Transform undocumented APIs into production-ready SDKs</p>
    </header>

    <div class="card">
        <h2>🎮 Demo Control Panel</h2>
        <div style="text-align: center;">
            <button id="start-demo" class="demo-button">🚀 Start Demo</button>
            <button id="reset-demo" class="demo-button" disabled>🔄 Reset Demo</button>
            <button id="skip-results" class="demo-button" disabled>⏭️ Skip to Results</button>
        </div>
        
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
        <p id="progress-text" style="text-align: center; margin: 8px 0;">Ready to start demo</p>
    </div>

    <div class="card">
        <h2>💻 Live Terminal Output</h2>
        <div id="terminal" class="terminal">Waiting for demo to start...</div>
        <button id="clear-terminal" class="demo-button">🧹 Clear Terminal</button>
        <span style="float: right; color: #6c757d;">
            Time: <span id="timer">00:00</span>
        </span>
    </div>

    <div class="card">
        <h2>📊 Live Results Dashboard</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <span id="api-calls" class="stat-number">0</span>
                <div>API Calls Made</div>
            </div>
            <div class="stat-card">
                <span id="endpoints" class="stat-number">0</span>
                <div>Endpoints Discovered</div>
            </div>
            <div class="stat-card">
                <span id="tests" class="stat-number">0/15</span>
                <div>Tests Passed</div>
            </div>
            <div class="stat-card">
                <span id="deliverables" class="stat-number">0/6</span>
                <div>Deliverables Ready</div>
            </div>
        </div>
    </div>

    <div id="results-section" class="card" style="display: none;">
        <h2>🎉 Demo Results</h2>
        <div style="display: grid; gap: 16px;">
            <div style="padding: 16px; background: rgba(40, 167, 69, 0.1); border-left: 4px solid #28a745; border-radius: 4px;">
                <strong>📄 OpenAPI Specification</strong> - Complete GitHub API 3.1 spec with examples
                <button onclick="downloadSample('openapi')" class="demo-button" style="float: right;">⬇️ Download</button>
            </div>
            <div style="padding: 16px; background: rgba(40, 167, 69, 0.1); border-left: 4px solid #28a745; border-radius: 4px;">
                <strong>💻 TypeScript SDK</strong> - Production-ready with pagination and retry logic
                <button onclick="downloadSample('sdk')" class="demo-button" style="float: right;">👁️ View</button>
            </div>
            <div style="padding: 16px; background: rgba(40, 167, 69, 0.1); border-left: 4px solid #28a745; border-radius: 4px;">
                <strong>📮 Postman Collection</strong> - Ready-to-import API collection
                <button onclick="downloadSample('postman')" class="demo-button" style="float: right;">⬇️ Download</button>
            </div>
            <div style="padding: 16px; background: rgba(40, 167, 69, 0.1); border-left: 4px solid #28a745; border-radius: 4px;">
                <strong>📋 Evidence Report</strong> - Comprehensive API behavior documentation
                <button onclick="showEvidence()" class="demo-button" style="float: right;">👁️ View</button>
            </div>
        </div>
    </div>

    <footer style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #30363d;">
        <p>A Doc-less API Agent that transforms undocumented APIs into developer-ready tools</p>
        <p style="color: #6c757d; font-size: 0.9em;">Optimized for Hugging Face Spaces</p>
    </footer>

    <script>
        // Demo state
        let demoState = {
            currentStep: 0,
            totalSteps: 10,
            startTime: null,
            timer: null,
            apiCalls: 0,
            endpoints: 0,
            tests: 0,
            deliverables: 0
        };

        // Initialize demo
        function startDemo() {
            demoState.startTime = Date.now();
            demoState.currentStep = 1;
            
            document.getElementById('start-demo').disabled = true;
            document.getElementById('reset-demo').disabled = false;
            document.getElementById('skip-results').disabled = false;
            
            startTimer();
            runDemoSteps();
        }

        function resetDemo() {
            if (demoState.timer) clearInterval(demoState.timer);
            
            demoState = {
                currentStep: 0,
                totalSteps: 10,
                startTime: null,
                timer: null,
                apiCalls: 0,
                endpoints: 0,
                tests: 0,
                deliverables: 0
            };
            
            document.getElementById('start-demo').disabled = false;
            document.getElementById('reset-demo').disabled = true;
            document.getElementById('skip-results').disabled = true;
            document.getElementById('results-section').style.display = 'none';
            
            updateProgress();
            updateStats();
            clearTerminal();
        }

        function skipToResults() {
            demoState.currentStep = demoState.totalSteps;
            demoState.apiCalls = 25;
            demoState.endpoints = 8;
            demoState.tests = 15;
            demoState.deliverables = 6;
            
            updateProgress();
            updateStats();
            appendToTerminal('🚀 Demo fast-forwarded to completion!');
            showResults();
        }

        function runDemoSteps() {
            const steps = [
                { msg: '📥 Cloning repository...', delay: 2000 },
                { msg: '🛠️ Setting up environment...', delay: 3000 },
                { msg: '🔍 Discovering GitHub API endpoints...', delay: 4000, stats: { apiCalls: 5, endpoints: 3 } },
                { msg: '💻 Generating TypeScript SDK...', delay: 3000, stats: { deliverables: 1 } },
                { msg: '🧪 Testing live API integration...', delay: 4000, stats: { apiCalls: 8, tests: 5 } },
                { msg: '🧬 Launching Mock Lab services...', delay: 2000 },
                { msg: '🔐 Testing OAuth2 PKCE flow...', delay: 3000, stats: { tests: 3 } },
                { msg: '🪝 Testing webhook verification...', delay: 2500, stats: { tests: 2 } },
                { msg: '📊 Generating evidence report...', delay: 3000, stats: { deliverables: 3, endpoints: 5 } },
                { msg: '🎉 Demo completed successfully!', delay: 1000, final: true }
            ];

            function runStep(index) {
                if (index >= steps.length) return;
                
                const step = steps[index];
                appendToTerminal(step.msg);
                
                setTimeout(() => {
                    if (step.stats) {
                        Object.keys(step.stats).forEach(key => {
                            demoState[key] += step.stats[key];
                        });
                        updateStats();
                    }
                    
                    demoState.currentStep++;
                    updateProgress();
                    
                    if (step.final) {
                        showResults();
                    } else {
                        runStep(index + 1);
                    }
                }, step.delay);
            }
            
            runStep(0);
        }

        function updateProgress() {
            const percentage = (demoState.currentStep / demoState.totalSteps) * 100;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-text').textContent = 
                `Step ${demoState.currentStep}/${demoState.totalSteps} - ${Math.round(percentage)}% complete`;
        }

        function updateStats() {
            document.getElementById('api-calls').textContent = demoState.apiCalls;
            document.getElementById('endpoints').textContent = demoState.endpoints;
            document.getElementById('tests').textContent = `${demoState.tests}/15`;
            document.getElementById('deliverables').textContent = `${demoState.deliverables}/6`;
        }

        function startTimer() {
            demoState.timer = setInterval(() => {
                const elapsed = Date.now() - demoState.startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('timer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function appendToTerminal(message) {
            const terminal = document.getElementById('terminal');
            const timestamp = new Date().toLocaleTimeString();
            terminal.textContent += `[${timestamp}] ${message}\n`;
            terminal.scrollTop = terminal.scrollHeight;
        }

        function clearTerminal() {
            document.getElementById('terminal').textContent = 'Terminal cleared.\n';
        }

        function showResults() {
            document.getElementById('results-section').style.display = 'block';
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        }

        function downloadSample(type) {
            const samples = {
                openapi: {
                    openapi: '3.1.0',
                    info: { title: 'GitHub API - Doc-less Agent Discovery', version: '1.0.0' },
                    paths: { '/user/repos': { get: { summary: 'List repositories' } } }
                },
                postman: {
                    info: { name: 'GitHub API Collection' },
                    item: [{ name: 'Get Repositories', request: { method: 'GET', url: 'https://api.github.com/user/repos' } }]
                }
            };
            
            if (samples[type]) {
                const blob = new Blob([JSON.stringify(samples[type], null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${type}-sample.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        function showEvidence() {
            alert('📋 Evidence Report\n\nComprehensive API behavior documentation including:\n• API call logs\n• Rate limiting patterns\n• Pagination analysis\n• Authentication flows\n• Error handling patterns\n\nGenerated automatically during API discovery process.');
        }

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('start-demo').addEventListener('click', startDemo);
            document.getElementById('reset-demo').addEventListener('click', resetDemo);
            document.getElementById('skip-results').addEventListener('click', skipToResults);
            document.getElementById('clear-terminal').addEventListener('click', clearTerminal);
            
            console.log('✅ Doc-less API Agent demo initialized');
        });
    </script>
</body>
</html>
